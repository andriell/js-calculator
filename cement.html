<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cement</title>
    <style>
        table td {
            padding: 5px;
        }
        .input {
            width: 50px;
        }
    </style>
</head>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">

    var calculator = {
        // для этого боъема м3 приведены пропорции в кг
        propsV: 100000,
        // Количество материалов указано с учетом 25% усадки раствора.
        props: {
            '300': {
                '100': {'cement': 40625000, 'sand': 150000000},
                '150': {'cement': 81250000, 'sand': 100000000},
                '200': {'cement': 81250000, 'sand': 100000000}
            },
            '400': {
                '100': {'cement': 32500000, 'sand': 160000000},
                '150': {'cement': 54166661, 'sand': 133333340},
                '200': {'cement': 54166661, 'sand': 133333340},
                '300': {'cement': 81250000, 'sand': 100000000}
            },
            '500': {
                '100': {'cement': 27083339, 'sand': 166666660},
                '150': {'cement': 36111108, 'sand': 155555560},
                '200': {'cement': 40625000, 'sand': 150000000},
                '300': {'cement': 54166661, 'sand': 133333340}
            },
            '600': {
                '100': {'cement': 23214279, 'sand': 171428580},
                '150': {'cement': 32500000, 'sand': 160000000},
                '200': {'cement': 32500000, 'sand': 160000000},
                '300': {'cement': 40625000, 'sand': 150000000}
            }
        },
        buttonCalculate: null,

        inputLength: null,
        inputWidth: null,
        inputHeight: null,
        inputMCement: null,
        inputMConcrete: null,

        outputConcreteMass: null,
        outputConcreteVolume: null,
        outputCementMass: null,
        outputCementVolume: null,
        outputSandMass: null,
        outputSandVolume: null,

        calculate: function () {
            // Объем в м3
            var volume = parseFloat(calculator.inputLength.val().replace(',', '.')) * parseFloat(calculator.inputWidth.val().replace(',', '.')) * parseFloat(calculator.inputHeight.val().replace(',', '.')) / 1000;
            calculator.outputConcreteVolume.html(volume);

            var mCement = calculator.inputMCement.filter(':checked').val();
            var mConcrete = calculator.inputMConcrete.filter(':checked').val();

            var cementMass = calculator.props[mCement][mConcrete]['cement'] / calculator.propsV * volume;
            calculator.outputCementMass.html(Math.round(cementMass));


            var sandMass = calculator.props[mCement][mConcrete]['sand'] / calculator.propsV * volume;
            calculator.outputSandMass.html(Math.round(sandMass));

            calculator.outputConcreteMass.html(Math.round(cementMass + sandMass));
        },

        init: function () {
            calculator.inputLength.on('change', calculator.calculate);
            calculator.inputWidth.on('change', calculator.calculate);
            calculator.inputHeight.on('change', calculator.calculate);
            calculator.inputMCement.on('change', calculator.calculate);
            calculator.inputMConcrete.on('change', calculator.calculate);
            calculator.buttonCalculate.on('click', calculator.calculate);

            calculator.inputMCement.filter('[value=500]').prop('checked', true);
            calculator.inputMConcrete.filter('[value=200]').prop('checked', true);
            calculator.inputMCement.on('change', function () {
                var val = parseInt(calculator.inputMCement.filter(':checked').val());
                calculator.inputMConcrete.filter('[value=300]').prop('disabled', val === 300);
                calculator.inputMConcrete.filter('[value=200]').prop('checked', true);
            });
        }
    };

    jQuery(function () {
        calculator.buttonCalculate = jQuery('#calculate');

        calculator.inputLength = jQuery('#length');
        calculator.inputWidth = jQuery('#width');
        calculator.inputHeight = jQuery('#height');
        calculator.inputMCement = jQuery('input[name=m_cement]');
        calculator.inputMConcrete = jQuery('input[name=m_concrete]');

        calculator.outputConcreteMass = jQuery('#output_concrete_mass');
        calculator.outputConcreteVolume = jQuery('#output_concrete_volume');
        calculator.outputCementMass = jQuery('#output_cement_mass');
        calculator.outputCementVolume = jQuery('#output_cement_volume');
        calculator.outputSandMass = jQuery('#output_sand_mass');
        calculator.outputSandVolume = jQuery('#output_sand_volume');

        calculator.init();
    });
</script>

<table>
    <tr>
        <td></td>
        <td>кг</td>
        <td>м3</td>
    </tr>
    <tr>
        <td>Объем раствора для заливки</td>
        <td><span id="output_concrete_mass"></span></td>
        <td><span id="output_concrete_volume"></span></td>
    </tr>
    <tr>
        <td>Количество цемента</td>
        <td><span id="output_cement_mass"></span></td>
        <td><span id="output_cement_volume"></span></td>
    </tr>
    <tr>
        <td>Количество песка</td>
        <td><span id="output_sand_mass"></span></td>
        <td><span id="output_sand_volume"></span></td>
    </tr>
    <tr>
        <td colspan="3">Количество материалов указано с учетом 25% усадки раствора.</td>
    </tr>
</table>

<h2>
    Новый расчет цементной стяжки пола
</h2>
<table>
    <tr>
        <td><label for="length">Длина комнаты:</label></td>
        <td><input type="text" id="length" class="input" maxlength="5" value="7"> метров</td>
    </tr>
    <tr>
        <td><label for="width">Ширина комнаты:</label></td>
        <td><input type="text" id="width" class="input" maxlength="5" value="5"> метров</td>
    </tr>
    <tr>
        <td><label for="height">Толщина слоя:</label></td>
        <td><input type="text" id="height" class="input" maxlength="3" value="80"> мм</td>
    </tr>
    <tr>
        <td>Марка цемента:</td>
        <td>
            <input type="radio" name="m_cement" id="m_cement_300" value="300"><label for="m_cement_300"><span></span>300</label>&nbsp;&nbsp;
            <input type="radio" name="m_cement" id="m_cement_400" value="400"><label for="m_cement_400"><span></span>400</label>&nbsp;&nbsp;
            <input type="radio" name="m_cement" id="m_cement_500" value="500"><label for="m_cement_500"><span></span>500</label>&nbsp;&nbsp;
            <input type="radio" name="m_cement" id="m_cement_600" value="600"><label for="m_cement_600"><span></span>600</label>&nbsp;&nbsp;
        </td>
    </tr>
    <tr>
        <td>Марка раствора:</td>
        <td>
            <input type="radio" name="m_concrete" id="m_concrete_100" value="100"><label for="m_concrete_100">100</label>&nbsp;&nbsp;
            <input type="radio" name="m_concrete" id="m_concrete_150" value="150"><label for="m_concrete_150">150</label>&nbsp;&nbsp;
            <input type="radio" name="m_concrete" id="m_concrete_200" value="200"><label for="m_concrete_200">200</label>&nbsp;&nbsp;
            <input type="radio" name="m_concrete" id="m_concrete_300" value="300"><label for="m_concrete_300">300</label>&nbsp;&nbsp;
        </td>
    </tr>
    <tr>
        <td colspan="2"><input id="calculate" type="button" value="Рассчитать количество цемента и песка"></td>
    </tr>
</table>


</body>
</html>